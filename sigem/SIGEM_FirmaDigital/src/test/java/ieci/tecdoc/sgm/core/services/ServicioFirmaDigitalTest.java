package ieci.tecdoc.sgm.core.services;

import ieci.tecdoc.sgm.core.base64.Base64;
import ieci.tecdoc.sgm.core.exception.SigemException;
import ieci.tecdoc.sgm.core.services.cripto.firma.ResultadoValidacionFirma;
import ieci.tecdoc.sgm.core.services.cripto.firma.ServicioFirmaDigital;

import java.io.File;
import java.io.FileInputStream;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

import junit.framework.TestCase;

import org.apache.commons.lang.StringUtils;

import sun.misc.BASE64Encoder;

public class ServicioFirmaDigitalTest extends TestCase {
	private final String cadAFirmar="qwerqwerqwerqewrsdklfjasñdkfjq`weifjañsdkfjañdsjfsdfadsfdsafds";
	
	public void testFirma() {
		System.setProperty("javax.xml.soap.MessageFactory","org.apache.axis.soap.MessageFactoryImpl");
		
		String datos = cadAFirmar;
		try {
			BASE64Encoder encoder = new BASE64Encoder();
			ServicioFirmaDigital oService = LocalizadorServicios.getServicioFirmaDigital(ConstantesServicios.LOCAL_SERVICE_DIGITAL_SIGN_AFIRMA_IMPL);
			String cResultado = oService.firmar(datos.getBytes());
			System.out.println(cResultado);
			assertNotNull(cResultado);
			return;
		} catch (SigemException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		fail();
	}
	
	public void testValidacionFirma(){
		try{
//			String firmaConCertificadoNoValido="MIIOnAYJKoZIhvcNAQcCoIIOjTCCDokCAQExCzAJBgUrDgMCGgUAMAsGCSqGSIb3DQEHAaCCAqYw"+
//			"ggKiMIIBigIKHvwX6QAAAAAAWjANBgkqhkiG9w0BAQUFADAUMRIwEAYDVQQDDAlQcnVUZWNEb2Mw"+
//			"HhcNMTEwODAyMTIyMTAxWhcNMzYwMzIzMTIyMTAxWjCBlDELMAkGA1UEBhMCRVMxEDAOBgNVBAgM"+
//			"B0VTUEHCpUExDzANBgNVBAcMBk1BRFJJRDEPMA0GA1UECgwGSUVDSVNBMRswGQYDVQQLDBJHRVNU"+
//			"SU9OIERPQ1VNRU5UQUwxFTATBgNVBAMMDE5PTUJSRSBTSUdFTTEdMBsGCSqGSIb3DQEJARYOc2ln"+
//			"ZW1Ac2lnZW0uZXMwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAMZ+dBcCp9dZWTjNAdTW9US2"+
//			"8JrhObWU+841bsMXEir8jUyv7ZtCsO0b10MN1OsFMco5Ovb6Kowm+ElRXO9cs+nHvd5aGr0Abp45"+
//			"h6wfm1SeJxHcXniF9acZL7RmPVMOESGMMkh6iWgABCeybFxvucXATc/0gUKtqMadiUotjQoXAgMB"+
//			"AAEwDQYJKoZIhvcNAQEFBQADggEBADmd/81Uvw1MrmlfijMoU3QY58yblQWQxVCln5M9oWx3Ebji"+
//			"CJ2H/aJvwbGwwOMTPbnVpSJcqiF+VX9ayQG4Ore+lLslGpF7fP+uiRtYonst+5eIwmFkTIiYGG3O"+
//			"TDMofpZ/OBDGtNE13mnBabpFVRw3v+IXWfy7PmwM3ZYdeJXdndjRFee2ALa0KHlbKk9DZgj6wEN/"+
//			"rSByFFBWbgjdU/0weM9C1PRpC2puTXzu1uklyHXo/WLW9RHXM6wYXXnRC/UZGrqHmAVjB/XYnhwW"+
//			"2E2NDsiaWiDy/J46bZBFrnmfRZEex1bi8vt8w3YXWod8iMPMzk+t3TGcyOmbTkhsvSkxggu+MIIL"+
//			"ugIBATAiMBQxEjAQBgNVBAMMCVBydVRlY0RvYwIKHvwX6QAAAAAAWjAJBgUrDgMCGgUAoIGbMBgG"+
//			"CSqGSIb3DQEJAzELBgkqhkiG9w0BBwEwGQYDVQQtMRITEDEzMjgxNzM5ODMxMjA4MDMwHAYJKoZI"+
//			"hvcNAQkFMQ8XDTEyMDIwMjA5MzAyOFowIQYDVQQFMRoTGDE0NjMyMTI5NjkwMDk5NjYwOTM0MzU3"+
//			"ODAjBgkqhkiG9w0BCQQxFgQUD3TDWhbwjXqXuLmhcTG3mobvlMAwDQYJKoZIhvcNAQEFBQAEgYCv"+
//			"OQPHJb7kMeYKtaGEkDRTbAMZkv/zCWhK5K/09LuHfN8PqXHHM/e8OjUElZWiLnqBBU/Qu6xzENdh"+
//			"W2dtN81UQrMIr3x7SeU2g8qAU+Ao36uMgnvnINrb1aXKcoIP4PN3g93/vLfrTXjtF5HRqUS9oOSc"+
//			"LYbeuvHotRg7GaGyL6GCClQwggpQBgsqhkiG9w0BCRACDjGCCj8wggo7BgkqhkiG9w0BBwKgggos"+
//			"MIIKKAIBAzELMAkGBSsOAwIaBQAwZwYLKoZIhvcNAQkQAQSgWARWMFQCAQEGC2CFVAEDAQEEAgEC"+
//			"MCEwCQYFKw4DAhoFAAQUItO+PZPHkPLIdNmUknb92RiVUUACA0ce3hgPMjAxMjAyMDIwOTMwMjha"+
//			"MAkCAQGAAQGBAQKgggdzMIIHbzCCBlegAwIBAgIDBQeeMA0GCSqGSIb3DQEBBQUAMEQxCzAJBgNV"+
//			"BAYTAkVTMQ0wCwYDVQQKEwRNREVGMQwwCgYDVQQLEwNQS0kxGDAWBgNVBAMTD01JTklTREVGLUVD"+
//			"LVdQRzAeFw0xMTA4MTcwOTUwMjJaFw0yMTA4MTcwOTUwMjJaMHIxCzAJBgNVBAYTAkVTMQ0wCwYD"+
//			"VQQKDARNREVGMQwwCgYDVQQLDANQS0kxEjAQBgNVBAUTCVMyODMzMDAyRTEyMDAGA1UEAwwpU2Vs"+
//			"bG8gZGUgdGllbXBvIFRTQCAtIEBmaXJtYSAtIGRlc2Fycm9sbG8wggEiMA0GCSqGSIb3DQEBAQUA"+
//			"A4IBDwAwggEKAoIBAQCgwVZQB5Lfhe7nJeuBHJ3ft88sv9GZjwZVrJ31IWcozouIdMo19UABAZ0r"+
//			"HrOUbX/35J0TmRWIt/61mFo3QqXlQJRQYRvMHAZtMQhLRECI4nbYkkkwvSGln/GEJ2g3j8g2u4JO"+
//			"MxVmj1jLtZMaAlPWKiH2B7UcR8cjvNalD0XHA1z542YD6WHTWvb9ojXD6zHa1N2HCc+TVt1h1ja9"+
//			"RbNJ2QL9KizQHkRwTP7HbjIfRjOB7HZdHdXtw8ZvuIoYLAD4YujnUkaY+Z0t/w5qhDMQiKKXiEkP"+
//			"DFU7GG1578dLDqYTuAmPDuGKBhFCbdTxRhIuhXLz438uEskGdZAXrC+nAgMBAAGjggQ6MIIENjCB"+
//			"8QYDVR0RBIHpMIHmgRZzb3BvcnRlLmFmaXJtYTVAbXB0LmVzpIHLMIHIMR4wHAYJYIVUAQMFAgIB"+
//			"DA9zZWxsbyBkZSB0aWVtcG8xUDBOBglghVQBAwUCAgIMQU1pbmlzdGVyaW8gZGUgbGEgUG9sw610"+
//			"aWNhIFRlcnJpdG9yaWFsIHkgQWRtaW5pc3RyYWNpw7NuIFDDumJsaWNhMRgwFgYJYIVUAQMFAgID"+
//			"DAlTMjgzMzAwMkUxOjA4BglghVQBAwUCAgUMK1RTQC0gQXV0b3JpZGFkIFNlbGxhZG8gZGUgdGll"+
//			"bXBvLWRlc2Fycm9sbG8wgcQGA1UdEgSBvDCBuYEPYWdwbWRAb2MubWRlLmVzpIGlMIGiMQswCQYD"+
//			"VQQGEwJFUzENMAsGA1UECgwETURFRjEMMAoGA1UECwwDUEtJMSYwJAYDVQQHDB1BcnR1cm8gU29y"+
//			"aWEgMjg5IDI4MDcxIE1hZHJpZDESMBAGA1UEBRMJUzI4MDAyMzFJMSkwJwYDVQQLDCBNaW5pc3Rl"+
//			"cmlvIGRlIERlZmVuc2EgZGUgRXNwYcOxYTEPMA0GA1UEAwwGUEtJREVGMAwGA1UdEwEB/wQCMAAw"+
//			"DgYDVR0PAQH/BAQDAgbAMBYGA1UdJQEB/wQMMAoGCCsGAQUFBwMIMB0GA1UdDgQWBBTrdJ9nNZTm"+
//			"0L9WlyFzLCWOt/Pt1zA4BggrBgEFBQcBAQQsMCowKAYIKwYBBQUHMAGGHGh0dHA6Ly9ldjAxLXdw"+
//			"Zy5tZGVmLmVzOjkzMDgwRAYDVR0gBD0wOzA5BglghVQBAQEBAwQwLDAqBggrBgEFBQcCARYeaHR0"+
//			"cDovL3BraS5tZGVmLmVzL2Nwcy9jcHMuaHRtMB8GA1UdIwQYMBaAFKvjuSGAW/p2D8dG27CbiAta"+
//			"scqyMIIBgQYDVR0fBIIBeDCCAXQwggFwoIIBbKCCAWiGgbZsZGFwOi8vL0NOPU1JTklTREVGLUVD"+
//			"LVdQRyxDTj1FQy1XUEcsQ049Q0RQLENOPVB1YmxpYyUyMEtleSUyMFNlcnZpY2VzLENOPVNlcnZp"+
//			"Y2VzLENOPUNvbmZpZ3VyYXRpb24sREM9ZXQsREM9bWRlLERDPWVzP2NlcnRpZmljYXRlUmV2b2Nh"+
//			"dGlvbkxpc3Q/YmFzZT9vYmplY3RjbGFzcz1jUkxEaXN0cmlidXRpb25Qb2ludIZ9bGRhcDovL2xk"+
//			"YXAubWRlZi5lcy9jbj1NSU5JU0RFRi1DUkwtRUMtV1BHLE9VPVBLSSxPPU1ERUYsQz1FUz9jZXJ0"+
//			"aWZpY2F0ZVJldm9jYXRpb25MaXN0P2Jhc2U/b2JqZWN0Y2xhc3M9Y1JMRGlzdHJpYnV0aW9uUG9p"+
//			"bnSGLmh0dHA6Ly9wa2kubWRlZi5lcy9jcmwvTUlOSVNERUYtQ1JMLUVDLVdQRy5jcmwwDQYJKoZI"+
//			"hvcNAQEFBQADggEBALk7tZzaf/jGkbiahLjLGaMrnxUaPcD8rC3keurxXJberQDC9FjZ3Oi3424l"+
//			"Q2SgPYZsT1sFHmGHylMJ6Rj0k8dcWCJ/JFM8UU4xU3z8WtyfxpQBz6JM/OxGsqPwawwSSVgh8Pns"+
//			"dZ3VKTWsryLj4ROTlst7h2IOkGIh1+d5A0XWQy0A9BjLuvJKAuhI7IA+y0kojfAkblLXDDDxQemx"+
//			"mqgj/84xYOgev1P/2Ecfxll6II9FrsfVmYywaEcERzBiuwX2AU1+NCO4l+GDk9FaHBz63GwKDuXg"+
//			"A0CEL+1RnTi469L+RVYSeZd731hkbWcj3Yy9+lPoB8/c7rHJ7gIHa+gxggI0MIICMAIBATBLMEQx"+
//			"CzAJBgNVBAYTAkVTMQ0wCwYDVQQKEwRNREVGMQwwCgYDVQQLEwNQS0kxGDAWBgNVBAMTD01JTklT"+
//			"REVGLUVDLVdQRwIDBQeeMAkGBSsOAwIaBQCggb8wGgYJKoZIhvcNAQkDMQ0GCyqGSIb3DQEJEAEE"+
//			"MCMGCSqGSIb3DQEJBDEWBBT5hx/dw7ctzLIWaUbMhSwjZYdoozB8BgsqhkiG9w0BCRACDDFtMGsw"+
//			"aTBnBBT3oha42ij3HgcZMRG9GKsqVen0qzBPMEikRjBEMQswCQYDVQQGEwJFUzENMAsGA1UEChME"+
//			"TURFRjEMMAoGA1UECxMDUEtJMRgwFgYDVQQDEw9NSU5JU0RFRi1FQy1XUEcCAwUHnjANBgkqhkiG"+
//			"9w0BAQEFAASCAQBGFFOPqBfNhwC/KetLZTHoWu65VdUGEj83mfQJyhmtd4O6IhSHfrOYOMTbzffW"+
//			"UKPJvxBR+R98vvfvqIxKBv2i9ynzHevXjzjiwmtbPn52PhMBSMSnytEPaGm4lNRnIjz5Ripf59Uy"+
//			"YC/FOO06SQnNhzpwo2mt1vbCw3+5z1O7hGnzJ2AMhBpOnSdq4QA6/m7mfyBEsYfd7fijvoumCf7W"+
//			"Mo8TyKqhxwPxt1PbV+J/t5/4NHsLvMqTx7/kd2GG06x689MqEaS2nFqKhCvpJT5oktEq4HXx5GbP"+
//			"b4uC54IKWFHCk9DSZ98g08kCmM0o/crON6J4dJOumcqQuvGyzxet";
			
			String firmaAValidar="MIIQrQYJKoZIhvcNAQcCoIIQnjCCEJoCAQExCzAJBgUrDgMCGgUAMAsGCSqGSIb3DQEHAaCCBKkw"+
			"ggSlMIIEDqADAgECAgQ8uyG8MA0GCSqGSIb3DQEBBQUAMDYxCzAJBgNVBAYTAkVTMQ0wCwYDVQQK"+
			"EwRGTk1UMRgwFgYDVQQLEw9GTk1UIENsYXNlIDIgQ0EwHhcNMTAwNDA2MDgwMzA4WhcNMTIwNDA2"+
			"MDgwMzA4WjCBxjELMAkGA1UEBhMCRVMxDTALBgNVBAoTBEZOTVQxGDAWBgNVBAsTD0ZOTVQgQ2xh"+
			"c2UgMiBDQTESMBAGA1UECxMJNTAwMDUxNTI2MXoweAYDVQQDE3FFTlRJREFEIElORk9STUFUSUNB"+
			"IEVMIENPUlRFIElOR0xFUyBTQSAtIENJRiBBMjg4NTUyNjAgLSBOT01CUkUgWkFSQUdPWkEgQVJS"+
			"SUJBUyBGUkFOQ0lTQ08gSkFWSUVSIC0gTklGIDUxOTU5MTAzWDCBnzANBgkqhkiG9w0BAQEFAAOB"+
			"jQAwgYkCgYEA1HnFzWyngtpdlRnYdqFS1pG3SBjXB9ddLko66UDfOZrRjvG3jjpGxvPHYNNuqv+z"+
			"Kww/Vdm4DaC6vM4MtkZcm2oQdqATbIjlyE8Kgp6Q1iqbGlyN3zF4X7SRrE/rM4pRMNXf7O0g+K4D"+
			"7FKa1RvjXX5ME6zbRXuy7H2JP0Vfb18CAwEAAaOCAi0wggIpMIHxBgNVHREEgekwgeaBKUZSQU5D"+
			"SVNDT0pBVklFUl9aQVJBR09aQUBFTENPUlRFSU5HTEVTLkVTpIG4MIG1MRgwFgYJKwYBBAGsZgEH"+
			"EwlBMjg4NTUyNjAxLTArBgkrBgEEAaxmAQYTHklORk9STUFUSUNBIEVMIENPUlRFIElOR0xFUyBT"+
			"QTEYMBYGCSsGAQQBrGYBBBMJNTE5NTkxMDNYMRYwFAYJKwYBBAGsZgEDEwdBUlJJQkFTMRcwFQYJ"+
			"KwYBBAGsZgECEwhaQVJBR09aQTEfMB0GCSsGAQQBrGYBARMQRlJBTkNJU0NPIEpBVklFUjAJBgNV"+
			"HRMEAjAAMCsGA1UdEAQkMCKADzIwMTAwNDA2MDgwMzA4WoEPMjAxMjA0MDYwODAzMDhaMAsGA1Ud"+
			"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"+
			"ZCBTZWxsYWRvIGRlIHRpZW1wby1kZXNhcnJvbGxvMIHEBgNVHRIEgbwwgbmBD2FncG1kQG9jLm1k"+
			"ZS5lc6SBpTCBojELMAkGA1UEBhMCRVMxDTALBgNVBAoMBE1ERUYxDDAKBgNVBAsMA1BLSTEmMCQG"+
			"A1UEBwwdQXJ0dXJvIFNvcmlhIDI4OSAyODA3MSBNYWRyaWQxEjAQBgNVBAUTCVMyODAwMjMxSTEp"+
			"MCcGA1UECwwgTWluaXN0ZXJpbyBkZSBEZWZlbnNhIGRlIEVzcGHDsWExDzANBgNVBAMMBlBLSURF"+
			"RjAMBgNVHRMBAf8EAjAAMA4GA1UdDwEB/wQEAwIGwDAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDAd"+
			"BgNVHQ4EFgQU63SfZzWU5tC/Vpchcywljrfz7dcwOAYIKwYBBQUHAQEELDAqMCgGCCsGAQUFBzAB"+
			"hhxodHRwOi8vZXYwMS13cGcubWRlZi5lczo5MzA4MEQGA1UdIAQ9MDswOQYJYIVUAQEBAQMEMCww"+
			"KgYIKwYBBQUHAgEWHmh0dHA6Ly9wa2kubWRlZi5lcy9jcHMvY3BzLmh0bTAfBgNVHSMEGDAWgBSr"+
			"47khgFv6dg/HRtuwm4gLWrHKsjCCAYEGA1UdHwSCAXgwggF0MIIBcKCCAWygggFohoG2bGRhcDov"+
			"Ly9DTj1NSU5JU0RFRi1FQy1XUEcsQ049RUMtV1BHLENOPUNEUCxDTj1QdWJsaWMlMjBLZXklMjBT"+
			"ZXJ2aWNlcyxDTj1TZXJ2aWNlcyxDTj1Db25maWd1cmF0aW9uLERDPWV0LERDPW1kZSxEQz1lcz9j"+
			"ZXJ0aWZpY2F0ZVJldm9jYXRpb25MaXN0P2Jhc2U/b2JqZWN0Y2xhc3M9Y1JMRGlzdHJpYnV0aW9u"+
			"UG9pbnSGfWxkYXA6Ly9sZGFwLm1kZWYuZXMvY249TUlOSVNERUYtQ1JMLUVDLVdQRyxPVT1QS0ks"+
			"Tz1NREVGLEM9RVM/Y2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdD9iYXNlP29iamVjdGNsYXNzPWNS"+
			"TERpc3RyaWJ1dGlvblBvaW50hi5odHRwOi8vcGtpLm1kZWYuZXMvY3JsL01JTklTREVGLUNSTC1F"+
			"Qy1XUEcuY3JsMA0GCSqGSIb3DQEBBQUAA4IBAQC5O7Wc2n/4xpG4moS4yxmjK58VGj3A/Kwt5Hrq"+
			"8VyW3q0AwvRY2dzot+NuJUNkoD2GbE9bBR5hh8pTCekY9JPHXFgifyRTPFFOMVN8/Frcn8aUAc+i"+
			"TPzsRrKj8GsMEklYIfD57HWd1Sk1rK8i4+ETk5bLe4diDpBiIdfneQNF1kMtAPQYy7rySgLoSOyA"+
			"PstJKI3wJG5S1www8UHpsZqoI//OMWDoHr9T/9hHH8ZZeiCPRa7H1ZmMsGhHBEcwYrsF9gFNfjQj"+
			"uJfhg5PRWhwc+txsCg7l4ANAhC/tUZ04uOvS/kVWEnmXe99YZG1nI92MvfpT6AfP3O6xye4CB2vo"+
			"MYICNDCCAjACAQEwSzBEMQswCQYDVQQGEwJFUzENMAsGA1UEChMETURFRjEMMAoGA1UECxMDUEtJ"+
			"MRgwFgYDVQQDEw9NSU5JU0RFRi1FQy1XUEcCAwUHnjAJBgUrDgMCGgUAoIG/MBoGCSqGSIb3DQEJ"+
			"AzENBgsqhkiG9w0BCRABBDAjBgkqhkiG9w0BCQQxFgQUBcQlk050kCvjq+QImed+8EAUeyowfAYL"+
			"KoZIhvcNAQkQAgwxbTBrMGkwZwQU96IWuNoo9x4HGTERvRirKlXp9KswTzBIpEYwRDELMAkGA1UE"+
			"BhMCRVMxDTALBgNVBAoTBE1ERUYxDDAKBgNVBAsTA1BLSTEYMBYGA1UEAxMPTUlOSVNERUYtRUMt"+
			"V1BHAgMFB54wDQYJKoZIhvcNAQEBBQAEggEAMSI0tE9kji6LLf3hRNPFgHis3KcvyCnd0xy77RZx"+
			"If/+qV5qVmc91mwwwajNdavawqklM+GzSaM8DLtt7I1EF7KnpdgAnk+iP/QyTcnv/c6uAzuBlCiE"+
			"pnU3/dLkDpNsCicfn2Hpo3dHaIS7ZTQpoJ7zA/fOckBm3c0ILTy7AKhwm8l2YgT7jVOI0E8g5v63"+
			"hIKYSUQnLW0mTeetioo4Xq2jhZTFXr6iNBC3JM11QjNYMo6QuFXugay5ibZP02Mm4SFMOnC4PB1N"+
			"wNF7wdP7qqT7wkcGy5Eu4LwE+BtWGbT/8sAUtrCTooeouNLuDty/SuzGicDAQnhMnLuG8KDpeg==";
			
			//String datos2="IZENPECENSO000000";
			String datos=cadAFirmar;
			ServicioFirmaDigital oService = LocalizadorServicios.getServicioFirmaDigital(ConstantesServicios.LOCAL_SERVICE_DIGITAL_SIGN_AFIRMA_IMPL);
			ResultadoValidacionFirma oResultado = oService.validarFirma(firmaAValidar.getBytes(), datos.getBytes());
			System.out.println("OK");
			assertNotNull(oResultado);
			return;
		} catch (SigemException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		fail();
	}

	private boolean isBase64(String cadToTest){
		if(cadToTest.length()%4>0) return false;
		Pattern p = Pattern.compile("[A-Za-z0-9+/]+={0,3}");
        Matcher m = p.matcher(cadToTest);
        return m.find();
	}
	
	private byte[] loadCertificateFile(String pathCertificate){
		if(StringUtils.isEmpty(pathCertificate)) return null;
		byte[] encodedPublicKey=null;
		try{
		    File filePublicKey = new File(pathCertificate);
		    if(!filePublicKey.exists()) return null;
		    FileInputStream fis = new FileInputStream(filePublicKey);
			encodedPublicKey = new byte[(int) filePublicKey.length()];
			fis.read(encodedPublicKey);
			fis.close();
		}catch(Exception e){
			System.out.println(e.getMessage());
			e.printStackTrace();
		}
		
		byte [] encodedPublicKeyNoBase64=encodedPublicKey;
		
		//comprobar si es un certificado en formato CER
		final String CER_BEGIN="----BEGIN CERTIFICATE----";
		final String   CER_END="----END CERTIFICATE----";
		String posibleBase64String=new String(encodedPublicKey);
		int posIni=posibleBase64String.indexOf(CER_BEGIN);
		int posFin=posibleBase64String.indexOf(CER_END);
		if(posIni>-1 && posFin>-1 ){
			posIni+=CER_BEGIN.length()+1; posFin--;
			posibleBase64String=posibleBase64String.substring(posIni,posFin);
			posibleBase64String=posibleBase64String.replaceAll("\r?\n", "");
			encodedPublicKeyNoBase64=Base64.decode(posibleBase64String);
		}
		return encodedPublicKeyNoBase64;
	}
	
	public void testGetDigitalSignService() {
		try {
			String firma = new String("qwerqwerqwerqewrsdklfjasñdkfjq`weifjañsdkfjañdsjf");
			String datos = new String("qwerqwerqwerqewrsdklfjasñdkfjq`weifjañsdkfjañdsjfsdfadsfdsafds");
			BASE64Encoder encoder = new BASE64Encoder();
			ServicioFirmaDigital oService = LocalizadorServicios.getServicioFirmaDigital(ConstantesServicios.LOCAL_SERVICE_DIGITAL_SIGN_AFIRMA_IMPL);
			//String cResultado = oService.firmar((encoder.encode(firma.getBytes())).getBytes());
			//System.out.println(cResultado);
			//assertNotNull(cResultado);
			
			//String cResultado="MIAGCSqGSIb3DQEHAqCAMIACAQExCzAJBgUrDgMCGgUAMIAGCSqGSIb3DQEHAQAAoIAwggQjMIIDjKADAgECAgQ8tI7sMA0GCSqGSIb3DQEBBQUAMDYxCzAJBgNVBAYTAkVTMQ0wCwYDVQQKEwRGTk1UMRgwFgYDVQQLEw9GTk1UIENsYXNlIDIgQ0EwHhcNMDkxMDIxMTIwNjI5WhcNMTMxMDIxMTIwNjI5WjCB2zELMAkGA1UEBhMCRVMxDTALBgNVBAoTBEZOTVQxGDAWBgNVBAsTD0ZOTVQgQ2xhc2UgMiBDQTERMA8GA1UECxMIUHVibGljb3MxEjAQBgNVBAsTCTUwMDA3MDAxNTF8MHoGA1UEAxNzREVTQ1JJUENJT04gTk9USUZJQ0FDSU9ORVMgVEVMRU1BVElDQVMgU0VHVVJBUyAtIEVOVElEQUQgU09DSUVEQUQgRVNUQVRBTCBDT1JSRU9TIFkgVEVMRUdSQUZPUyBTLkEuIC0gQ0lGIEE4MzA1MjQwNzCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEAxJAaae0UoQHWcfTjXE30AowztYXmSJWmGTRN1ZefyfQ95Tml9VqAP3sMCDZmnJT+pwVfU0Jm2wmcommfyplTXBAKPolyi2KPMqb8FXwZSRGYZOqc5IcAJP6tuMJV/dSNls8R3qKuxsg8vd8jA5FIgiftzKMchHk4V8CsWKtf3gsCAwEAAaOCAZYwggGSMIGaBgNVHREEgZIwgY+kgYwwgYkxGDAWBgkrBgEEAaxmAQ8TCUE4MzA1MjQwNzE6MDgGCSsGAQQBrGYBDhMrU09DSUVEQUQgRVNUQVRBTCBDT1JSRU9TIFkgVEVMRUdSQUZPUyAgUy5BLjExMC8GCSsGAQQBrGYBCBMiTk9USUZJQ0FDSU9ORVMgVEVMRU1BVElDQVMgU0VHVVJBUzAJBgNVHRMEAjAAMCsGA1UdEAQkMCKADzIwMDkxMDIxMTIwNjI5WoEPMjAxMzEwMjExMjA2MjlaMAsGA1UdDwQEAwIFoDARBglghkgBhvhCAQEEBAMCBaAwHQYDVR0OBBYEFMDeBBq8I2QGj0G2PgvPH/FRAIwGMB8GA1UdIwQYMBaAFECadkSXdAfErBTLHo1POkV8MNdhMFsGA1UdHwRUMFIwUKBOoEykSjBIMQswCQYDVQQGEwJFUzENMAsGA1UEChMERk5NVDEYMBYGA1UECxMPRk5NVCBDbGFzZSAyIENBMRAwDgYDVQQDEwdDUkw2Mzk3MA0GCSqGSIb3DQEBBQUAA4GBAIUF/bNIOn5xh5vdbrkOKko5vDLp1oP5urBxyBfwDs7RdKVnbht+94rML93zes2/5SUD8dw6OrDarm8WCHwgTQIwzhHojlI+fsljW50nNkznhrhahP0apys2WhgPROGBTzTxOSsF3CKo0GV6xZLKW7l7NwWma5z5raruii9/l/T6AAAxggFDMIIBPwIBATA+MDYxCzAJBgNVBAYTAkVTMQ0wCwYDVQQKEwRGTk1UMRgwFgYDVQQLEw9GTk1UIENsYXNlIDIgQ0ECBDy0juwwCQYFKw4DAhoFAKBdMBgGCSqGSIb3DQEJAzELBgkqhkiG9w0BBwEwHAYJKoZIhvcNAQkFMQ8XDTExMDkyMzEzMjUyNVowIwYJKoZIhvcNAQkEMRYEFGMGdVIe3r9c0ExpqLB7Nh5w0FkGMA0GCSqGSIb3DQEBAQUABIGAl2X2RYJNrTDkisHziWzdRTwmGwBQ/SEPjJcT7vfzSxzCnIdKHBdsgRkbuGlzfbiZdEwQRlHwgYZNeL0/hvlpn2WVvqJ9Wz9CWWqd7zNbGOPHtT7uUSQua2QANkk8TFwT9RtpJj3wTGTXY2LsXClJOTL36T7pIGLX25I47GoJ62EAAAAAAAA=";
			String cResultado="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";
			cResultado="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";
			datos="IZENPECENSO000000";
			ResultadoValidacionFirma oResultado = oService.validarFirma(cResultado.getBytes(), datos.getBytes());
			System.out.println("OK");
			assertNotNull(oResultado);
			return;
		} catch (SigemException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		fail();
	}

}
